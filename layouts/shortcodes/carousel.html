<figure class="carousel" id="{{ .Get "id" }}">
    {{ $imagesParam := .Get "images" }}
    {{ $captionsParam := .Get "captions" }}
    {{ $images := split $imagesParam "," }}
    {{ $captions := split $captionsParam "|" }}

    <div class="carousel-inner">
        {{ range $index, $image := $images }}
        <div class="carousel-item{{ if eq $index 0 }} active{{ end }}">
            <img src="{{ $image }}" alt="{{ index $captions $index }}">
            <figcaption>{{ index $captions $index }}</figcaption>
        </div>
        {{ end }}
    </div>

    <!-- Кнопки пролистывания -->
    <div class="carousel-controls">
        <button type="button" class="carousel-control-prev">&lt;</button>
        <button type="button" class="carousel-control-next">&gt;</button>
    </div>
</figure>

<script>
    $(document).ready(function(){
        var carouselID = "#{{ .Get "id" }}";
        var $carousel = $(carouselID + ' .carousel-inner');
        var $captions = $(carouselID + ' figcaption');
        var totalSlides = $carousel.children().length;
        var currentSlide = 0;

        // Показать первую подпись
        $captions.eq(0).addClass('active');

        // Функция для обновления подписи
        function updateCaption(index) {
            $captions.removeClass('active');
            $captions.eq(index).addClass('active');
        }

        // Пролистывание карусели
        function goToSlide(index) {
            if (index >= 0 && index < totalSlides) {
                $carousel.children().removeClass('active');
                $carousel.children().eq(index).addClass('active');
                updateCaption(index);
                currentSlide = index;
            } else if (index < 0) {
                goToSlide(totalSlides - 1); // Переход на последний слайд
            } else if (index >= totalSlides) {
                goToSlide(0); // Переход на первый слайд
            }
        }

        // Клик на кнопку "назад"
        $(carouselID + ' .carousel-control-prev').click(function(){
            goToSlide(currentSlide - 1);
        });

        // Клик на кнопку "вперед"
        $(carouselID + ' .carousel-control-next').click(function(){
            goToSlide(currentSlide + 1);
        });

        // Свайп для мобильных устройств (пример)
        $carousel.swipe({
            swipeLeft:function(event, direction, distance, duration, fingerCount) {
                goToSlide(currentSlide + 1);
            },
            swipeRight:function(event, direction, distance, duration, fingerCount) {
                goToSlide(currentSlide - 1);
            },
            threshold: 0
        });

        // Дополнительные функции и настройки карусели
        $carousel.children().eq(0).addClass('active'); // Показать первый слайд

        // Инициализация карусели (если используется как плагин)
        // $carousel.slick({
        //     arrows: false,
        //     dots: false,
        //     autoplay: true,
        //     autoplaySpeed: 2000,
        //     fade: true
        // });
    });
</script>

<style>
    .carousel {
        position: relative;
        width: 100%;
        max-width: 760px;
        margin: 0 auto;
    }

    .carousel-inner {
        position: relative;
        width: 100%;
        overflow: hidden;
    }

    .carousel-item {
        display: none;
        text-align: center;
        transition: opacity 0.5s ease-in-out;
    }

    .carousel-item.active {
        display: block;
        opacity: 1;
    }

    .carousel-item img {
        max-width: 100%;
        height: auto;
    }

    figcaption {
        padding: 8px;
        color: black;
        text-align: center;
    }

    .carousel-controls {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        width: 100%;
        text-align: center;
        display: flex;
        justify-content: space-between;
        padding: 0 10px;
    }

    .carousel-control-prev, .carousel-control-next {
        background: none;
        color: black;
        border: none;
        cursor: pointer;
        padding: 10px 15px;
        font-size: 1.5rem;
    }

    .carousel-control-prev:hover, .carousel-control-next:hover {
        color: grey;
    }
</style>
