{{ $imagesParam := .Get "images" }}
{{ $captionsParam := .Get "captions" }}
{{ $images := split $imagesParam "," }}
{{ $captions := split $captionsParam "," }}
{{ $dots := .Get "dots" | default "true" }}
{{ $arrows := .Get "arrows" | default "true" }}
{{ $autoplay := .Get "autoplay" | default "true" }}
{{ $speed := .Get "speed" | default "500" }}

<style>
    .slick-carousel-wrapper {
        position: relative;
        margin-bottom: 60px; /* Добавляем место под подпись и зазор */
    }

    .slick-carousel {
        width: 100%; /* Устанавливаем ширину в 100% */
        max-width: 760px; /* Максимальная ширина */
        height: auto; /* Высота будет зависеть от содержания */
        overflow: hidden;
        position: relative;
        margin-bottom: 25px; /* Добавляем место под подпись */
    }

    .slick-carousel .slick-slide {
        width: 100%; /* Устанавливаем ширину в 100% */
        height: auto; /* Высота будет зависеть от содержания */
        text-align: center; /* Центрируем изображение */
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #d6d6d6; /* Цвет фона */
    }

    .slick-carousel .slick-slide img {
        max-width: 100%;
        max-height: 100%;
        width: auto;
        height: auto;
        margin: auto; /* Центрирование изображения */
    }

    .slick-prev, .slick-next {
        background: none;
        border: none;
        cursor: pointer;
        border-radius: 60%;
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        line-height: 1;
        z-index: 10;
    }

    .slick-prev {
        left: 10px;
    }

    .slick-next {
        right: 10px;
    }

    .slick-prev:before, .slick-next:before {
        font-family: 'slick';
        opacity: .7;
        color: white;
        line-height: 1;
        z-index: 1;
    }

    .slick-carousel-caption {
        position: absolute;
        bottom: -35px; /* Смещение подписи под слайдом */
        left: 50%;
        transform: translateX(-50%);
        padding: 10px; /* Внутренний отступ */
        box-sizing: border-box;
        margin: 0;
        width: 100%; /* Устанавливаем ширину в 100% */
        max-width: 760px; /* Максимальная ширина */
        text-align: center;
        font-family: Telegram Sans, sans-serif; /* Используемый шрифт */
        font-size: 1.2rem; /* Увеличенный размер шрифта */
        line-height: 1.2; /* Межстрочный интервал */
        z-index: 5; /* Обеспечиваем, чтобы подпись была выше других элементов */
    }
    .h4 {
        font-family: Telegram Sans, sans-serif;
        line-height: 1.2;
        color: #000000;
        font-weight: 200;
        font-size: 1.2rem; /* Увеличенный размер шрифта */
    }

    /* Мобильные стили */
    @media (max-width: 767px) {
        .slick-carousel-wrapper {
            margin-bottom: 40px; /* Уменьшаем отступ для мобильных */
        }

        .slick-carousel-caption {
            font-size: 1rem; /* Уменьшаем размер шрифта для мобильных */
            bottom: -25px; /* Уменьшаем отступ для подписи */
        }

        .slick-prev, .slick-next {
            top: 45%; /* Корректируем позиционирование стрелок */
        }
    }
</style>

<div class="slick-carousel-wrapper">
    <div class="slick-carousel" data-dots="{{ $dots }}" data-arrows="{{ $arrows }}" data-autoplay="{{ $autoplay }}" data-speed="{{ $speed }}">
        {{ range $index, $image := $images }}
            <div class="slick-slide">
                <img src="{{ $image }}" alt="{{ index $captions $index }}">
            </div>
        {{ end }}
    </div>

    <button type="button" class="slick-prev">Previous</button>
    <button type="button" class="slick-next">Next</button>
    <figcaption class="slick-carousel-caption h4">{{ index $captions 0 }}</figcaption> <!-- Подпись -->
</div>

<script>
    $(document).ready(function(){
        var $carousel = $('.slick-carousel');
        var $caption = $('.slick-carousel-caption');

        $carousel.on('init', function(event, slick){
            var captionText = $(slick.$slides[0]).find('img').attr('alt');
            $caption.text(captionText);
        });

        $carousel.on('beforeChange', function(event, slick, currentSlide, nextSlide){
            var nextCaption = $(slick.$slides[nextSlide]).find('img').attr('alt');
            $caption.text(nextCaption);
        });

        $carousel.slick({
            dots: $carousel.data('dots') === "true",
            arrows: $carousel.data('arrows') === "true",
            autoplay: $carousel.data('autoplay') === "true",
            speed: parseInt($carousel.data('speed')),
            slidesToShow: 1,
            slidesToScroll: 1,
            prevArrow: '.slick-prev',
            nextArrow: '.slick-next'
        });

        $('.slick-prev').click(function(){
            $carousel.slick('slickPrev');
        });

        $('.slick-next').click(function(){
            $carousel.slick('slickNext');
        });
    });
</script>
